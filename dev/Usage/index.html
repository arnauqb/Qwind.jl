<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Usage · Qwind Documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Qwind Documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">QWIND</a></li><li><a class="tocitem" href="../Setup/">Setup</a></li><li class="is-active"><a class="tocitem" href>Usage</a><ul class="internal"><li><a class="tocitem" href="#Configuration"><span>Configuration</span></a></li><li><a class="tocitem" href="#Running"><span>Running</span></a></li><li><a class="tocitem" href="#Running-in-parallel"><span>Running in parallel</span></a></li><li><a class="tocitem" href="#Reading-the-results"><span>Reading the results</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/arnauqb/Qwind.jl/blob/master/docs/src/Usage.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h1><h2 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h2><p>All the parameters in the code are specified through a parameter file. An example file can be found in <code>configs/config_example.yaml</code>.  All the parameter fields should be self explanatory when familiar with the paper release (TODO: link to arxiv)</p><pre><code class="language-yaml hljs"> black_hole:
  M: 1e8 # solar masses
  mdot: 0.5 # Eddington units
  spin: 0.0 # spin parameter (-1,1)

radiation:
  relativistic: true 
  f_uv: auto
  f_x: 0.15
  n_r: 1000 # number of bins in the disk
  disk_r_in: 6.0
  z_xray: 0.0
  disk_height: 0.0
  mu_nucleon: 0.61
  mu_electron: 1.17
  xray_opacity: boost 
  tau_uv_calculation: no_tau_uv 
  disk_integral_rtol: 1e-3
  wind_interpolator:
    update_grid_method: &quot;average&quot;
    vacuum_density: 1e2
    nz: 500
    nr: auto 

grid:
  r_min: 6.0
  r_max: 50000.0
  z_min: 0.0
  z_max: 50000.0

initial_conditions:
  mode: CAKIC 
  r_in: 50.0
  r_fi: 1500.0
  n_lines: auto
  log_spaced: true
  z0: 0.0 # Rg
  K: 0.03
  alpha: 0.6
  use_precalculated: true # use cached results

integrator:
  n_iterations: 5
  atol: 1e-8
  rtol: 1e-3
  save_path: &quot;./example&quot;</code></pre><h2 id="Running"><a class="docs-heading-anchor" href="#Running">Running</a><a id="Running-1"></a><a class="docs-heading-anchor-permalink" href="#Running" title="Permalink"></a></h2><p>To run the specified parameter file, we do</p><pre><code class="language-julia hljs">using Qwind
model = Model(&quot;configs/config_example.yaml&quot;)
iterations_dict = Dict()
run!(model, iterations_dict)</code></pre><p>The <code>iterations_dict</code> stores information about each iteration of the density grid, so we know how the wind properties and radiation field are changing throughout iterations. </p><h2 id="Running-in-parallel"><a class="docs-heading-anchor" href="#Running-in-parallel">Running in parallel</a><a id="Running-in-parallel-1"></a><a class="docs-heading-anchor-permalink" href="#Running-in-parallel" title="Permalink"></a></h2><p>The code automatically runs with all available cores to Julia. The number of cores that Julia can use can be specified as a launch flag, eg</p><pre><code class="language-bash hljs">julia -p 6</code></pre><p>will launch Julia with 6 cores. Alternatively, we can make us of the <code>Distributed</code> package,</p><pre><code class="language-julia hljs">using Distributed
addprocs(5)</code></pre><h2 id="Reading-the-results"><a class="docs-heading-anchor" href="#Reading-the-results">Reading the results</a><a id="Reading-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-the-results" title="Permalink"></a></h2><p>In the example above, the results will be stored in <code>./tests/results.hdf5</code>. A series of functions are built into QWIND to facilitate reading different data of interest.</p><h3 id="Streamlines"><a class="docs-heading-anchor" href="#Streamlines">Streamlines</a><a id="Streamlines-1"></a><a class="docs-heading-anchor-permalink" href="#Streamlines" title="Permalink"></a></h3><pre><code class="language-julia hljs">streamlines = Streamlines(&quot;example/results.hdf5&quot;);</code></pre><p>We can then easily plot them through</p><pre><code class="language-julia hljs">using PyPlot

fig, ax = plt.subplots()
for sl in sls
    ax.plot(sl.r, sl.z, linewidth=1)
end
ax.set_xlim(0,2500)
ax.set_ylim(0,2500)
ax.set_xlabel(L&quot;$R$ [ $R_g$ ]&quot;)
ax.set_ylabel(L&quot;$z$ [ $R_g$ ]&quot;)</code></pre><p><img src="../figures/streamlines.png" alt="Streamlines"/></p><p>By default, the streamlines of the latest iteration will be loaded. A specific iteration can be checked with</p><pre><code class="language-julia hljs">streamlines = Streamlines(&quot;example/results.hdf5&quot;, 2)</code></pre><h3 id="Density-Grid"><a class="docs-heading-anchor" href="#Density-Grid">Density Grid</a><a id="Density-Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Density-Grid" title="Permalink"></a></h3><p>Similarly,</p><pre><code class="language-julia hljs">dgrid = DensityGrid(&quot;./example/results.hdf5&quot;);

LogNorm = matplotlib.colors.LogNorm
fig, ax = plt.subplots()
cm = ax.pcolormesh(dgrid.r_range, dgrid.z_range, dgrid.grid&#39;, norm=LogNorm(1e4, 1e8))
plt.colorbar(cm, ax=ax)
ax.set_xlim(0,2500)
ax.set_ylim(0,2500)
ax.set_xlabel(L&quot;$R$ [ $R_g$ ]&quot;)
ax.set_ylabel(L&quot;$z$ [ $R_g$ ]&quot;)</code></pre><p><img src="../figures/density_grid.png" alt/></p><h3 id="Velocity-Grid"><a class="docs-heading-anchor" href="#Velocity-Grid">Velocity Grid</a><a id="Velocity-Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Velocity-Grid" title="Permalink"></a></h3><pre><code class="language-julia hljs">Normalize = matplotlib.colors.Normalize
fig, ax = plt.subplots(1, 3, figsize=(6,2), sharex=true, sharey=true)
ax[1].pcolormesh(vgrid.r_range, vgrid.z_range, vgrid.vr_grid&#39;, norm=Normalize(0, 0.5))
ax[2].pcolormesh(vgrid.r_range, vgrid.z_range, vgrid.vphi_grid&#39;, norm=Normalize(0, 0.5))
cm = ax[3].pcolormesh(vgrid.r_range, vgrid.z_range, vgrid.vz_grid&#39;, norm=Normalize(0, 0.5))
plt.colorbar(cm, ax=ax[3])
ax[1].set_ylim(0,2500)
ax[1].set_xlim(0,2500)
for i in 1:3
    ax[i].set_xlabel(L&quot;$R$ [ $R_g$ ]&quot;)
end
ax[1].set_ylabel(L&quot;$z$ [ $R_g$ ]&quot;)
ax[1].set_title(&quot;Vr&quot;)
ax[2].set_title(&quot;Vphi&quot;)
ax[3].set_title(&quot;Vz&quot;)
plt.subplots_adjust(wspace=0.05, hspace=0.05)</code></pre><p><img src="../figures/velocity_grid.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Setup/">« Setup</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.9 on <span class="colophon-date" title="Tuesday 19 October 2021 14:53">Tuesday 19 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
